SAP 공부

* ### 1 VPC 리소스에 대해 프라이빗 호스팅 영역 사용, 온프레미스 시스템이 해당 도메인 사용가능해야함,온프렘 네트워크와 트랜짓 게이트웨이 사이에 DX 연결, 최고성능으로 요구 충족
    * 프라이빗 호스팅 영역 모든 VPC 에 연결,공유 해야할 리소스에 Route53 Inbound Resolver 사용,모든 VPC 를 전송 게이트웨이에 연결, Resolver 를 가리키는 도메인에 대한 온프레미스 전달 규칙 생성
* ### 2 REST 기반 API 제공,API GW 호스팅 중, 각 API 작업에 대해 서로다른 Lambda 함수 통함,R53사용 하며 특정 레코드 생성,API 데이터는 Dynamo DB 저장, API 가 다른 리전으로 장애조치 가능해야함

    *  다른 리전에 새 API gw, Lambda 함수 배포, R53 DNS 레코드를 장애조치 래코드로 변경, 대상 상태 모니터링 활성화, DynamoDB 테이블을 전역으로 변경

* ### 3 단일 OU Organiztion 사용, 모든 계정은 해당 OU구성원, 관리자는 루트 거부목록 SCP를 사용하여 제한된 서비스 액세스 관리,새로운 사업부의 AWS 계정 초대,온보딩 후 회사 정책을 충족하기 위해 기존 Config 규칙 업데이트 불가.추가 장기 도입없이 변경사항을 적용및 현재 정책을 시행하는 방법

    * 새 계정에 대해 임시 OU 생성 임시 OU에 SCP 적용하여 Config 작업 허용, 조직의 루트 SCP 를 기존 OU 로 이동 AWS Config 조정이 완료되면 새 계정을 프로덕션 OU 로 이동

* ### 4 온프렘에서 2계층 웹 앱 실행, 앱 계층은 상태저장 앱을 실행하는 단일서버로 구성,앱은 별도 서버에서 실행되는 PostgreSQL에 연결, 사용자 기반이 크게 성장할 것으로 예상, AWS 로 마이그레이션 중,Aurora, EC2 ASG, ELB 사용, 앱 및 DB 계층을 확장할 수 있는 일관된 사용자 경험을 제공하는 솔루션
    * Aurora 복제본에 오토 스케일링 활성화, RR 및 고정세션이 활성화된 ALB 사용

* ### 5 온프렘에서 호스팅하는 앱에서 메타데이터 수집하기 위해 서비스 사용, 소비자 장치가 앱에 엑세스 구형장치는 특정 HTTP 헤더 지원않함, 해당 헤더가 응답에 있을시 오류 표시, 응답에서 지원하지 않은 헤더 제거하도록 온프레미스 로드밸런서 구성 근데 AWS 으로 마이그레이션,서버리스 채택,이전 장치 지원해야함, 이미 앱은 람다함수 세트로 구성완료
    * CF 배포, ALB 생성, CF 가 ALB 로 요청 전달하도록 구성,각 유형 요청에 대해 적절한 람다함수 호출,문제 있는 헤더를 제거하는 CF 함수 생성

* ### 6 계정A의 S3 버킷에 저장되어있는 데이터파일을 계정 B 의 IAM 사용자가 엑세스 가능해야함 S3 버킷 설정 어캐하누?
    ```json
        {
            "Effect":"Allow",
            "Principal":{
                "AWS":"arn:aws:iam::계정B:user/IAM사용자이름"
            },
            "Action":[
                "s3:GetObject",
                "s3:listBucket",
            ],
            "Resource":[
                "arn:aws:s3:::버킷이름/*"
            ]
        }
    ```

* ### 7 EC2에 웹 실행중,컨테이너 MSA 로 리팩터링,환경 분리,최소부하와 최대부하가 알려져있음,운영복잡성 낮춰
    * 컨테이너 이미지 ECR 업로드,Fargate 시작 유형 2개의 자동 확장 ECS 클러스터 구성, ECR 이미지에서 작업을 배포, 개별 ALB 구성후 ECS 트래픽 전달

* ### 8 ALB 뒤에있는 플릿에서 다중계층 앱 실행중,ASG EC2 사용중,ALB 및 ASG는 백업 리전에 복제, ASG Min,Max 값 0,R53 사용,백업리전으로 자동 장애 조치 해야함(RTO 15분) Active-Active 불가 돈 없어서,
    * 백업리전에서 Lambda 사용하여 읽기 전용 복제본 승격, ASG 값 수정, 웹 모니터링 하며 상태 비정상시 람다 함수에 SNS 알림 보내는 상태확인으로 R53 구성, 이후 헬스체크 실패시 백업 리전의 ALB로 트래픽 라우팅 하는 장애 조치 정책 으로 R 53 업데이트

* ### 9 단일 EC2 에서 중요 앱 호스팅, 인메모리 데이터 스토어 용 Redis 단일 클러스터 Elastic Cache 사용, RDS for MariaDB 인스턴스 사용, 아키 개선하여 다운타임 최소화 하며 장애 자동 복구 해야함.
    * ELB 사용하여 트래픽 분산, ASG 의 최소용량이 2개 인 그룹을 사용중인지 확인
    * RDS 다증 AZ 배포 활성화
    * Elastic Cache 복제 그룹 생성후 다중 AZ 활성화

* ### 10 ALB 뒤에 EC2 에서 실행되는 전자상 거래 앱, RDS 인스턴스 사용,CF 는 ALB를 가리키는 하나의 오리진으로 구성, 정적 콘텐츠 캐시,R53 모든 퍼블릭 영역을 호스팅, 업데이트 후 502 반환, ALB 반환되는 HTTP 헤더 원인, 사용자 오류 페이지 제공해야함,
  * S3 버킷 생성 후 정적 웹페이지 호스팅하도록 S3 버킷 구성 후 사용자 지정 오류 페이지 버킷에 업로드
  * CF 사용자 오류 페이지를 구성하여 사용자 지정 오류 응답 추가, 공개적으로 액세스가능한 웹을 가리키도록 DNS 수정

