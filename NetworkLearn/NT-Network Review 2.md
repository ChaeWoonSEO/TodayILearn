# 네트워크 복습 2

- 브리지 ID (BID)
  - 브리지나 스위치 들이 통신할 떄 서로를 확인 하기 위해 하나씩 가지고 있는 번호이다.
  - Bridge Priorty (브리지 우선순위)16bit , Mac 주소 48bit 로 구성되어있다.
    <img src="./image/a%20(1).png">
    [Bridge Priorty(브리지 우선순위)]
  - 16bit이므로  0 ~ 2의16승 - 1 (0~65535) 디폴트 값으로 그 중간값인 32768 을 사용한다.
  - Priorty 는 낮은 값이 더 높은 우선순위임
- Path cost 
  - 브리지가 얼마나 가까이 , 더 빠른 링크로 연결되어 있는지 알아내기 위한 값
  - 한스위치 에서 다른 스위치로 가는데 드는 비용
  
    ``` 
    (물론 브리지 와 스위치는 다른 개념이지만 현재는 브리지와 호스트가 같은 개념으로 생각해도 무방함)
    ```
  - 1Gbps, 10Gbps, 2.4Gbps 등 다양한 속도가 나오면서, 소수점인 Path Cost 가 나오지 않도록 IEEE에서 Path Cost 값을 정해줌 (지금은 이 값을 사용)
  
    ex) 링크 대역폭이 10Gbps 일 경우, 
      
    Path Cost = 1000Mbps / 10Gbps
    = 1000Mbps / 10000Mbps = 0.1 -----> 소수점이라 불편 ㅠㅠ
    <img src="./image/c.png">

- 스패닝 트리 프로토콜 
  <img src ="./image/e.png">
  규칙 
  
  1. 네트워크 당 하나의 루트 브리지를 갖음
  2. Not Root Bridge 는 무조건 하나의 루트포트를 갖음
  (루트포트 : 루트브리지 와 가장 가까운 포트 = Path Cost 가 가장 적게 드는 포트)
  3. 세그먼트 당 하나의 Desinated Port 를 갖음 
  (세그먼트 : 브리지 또는 스위치 간의 연결링크 이다.)
  - **스패닝 트리 프로토콜 에서 루트 포트나 Desinated 포트가아닌 나머지 포트들은 다 막아버려서루핑 방지.** 

- BPDU (Bridge Protocol Data Unit)
  - 브리지는 스패닝 트리 정보를 자기들끼리 주고 받기 위해 특수한 프레임을 사용하는데 , 이를 BPDU 라고 한다.
  - BPDU 에 실려있는 내용 
    1. Root BID : 루트브리지의 브리지 아이디
    2. Root Path Cost : 루트브리지까지 가는 경로 값
    3. Sender BID : 보내는 브리지의 BID
    4. Port ID : 어떤 포트에서 보냈는지 알게해줌

  - 브리지나 스위치가 부팅하면 브리지는 모든 포트로 BPDU 를 매 2초 마다 보내면서 서로 스패닝 트리정보를 주고받음
  - BPDU 를 서로 주고 받으며 누가 루트브리지, 루트포트, Desinated Port 가 될건지 결정함.
  
  * **루트브리지 정하기**
    - 무조건 낮은 BID 를 갖는 브리지가 루트브리지임
    <img  src="./image/f.png">